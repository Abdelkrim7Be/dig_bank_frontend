<div class="container">
  <div class="row justify-content-center mt-5">
    <div class="col-md-6">
      <div class="card shadow">
        <div class="card-header bg-primary text-white">
          <h3 class="mb-0">Create Your Account</h3>
        </div>
        <div class="card-body p-4">
          <!-- Success Alert -->
          @if (successMessage) {
          <div
            class="alert alert-success alert-dismissible fade show"
            role="alert"
          >
            {{ successMessage }}
            <button
              type="button"
              class="btn-close"
              (click)="successMessage = null"
              aria-label="Close"
            ></button>
          </div>
          }

          <!-- Error Alert -->
          @if (errorMessage) {
          <div
            class="alert alert-danger alert-dismissible fade show"
            role="alert"
          >
            {{ errorMessage }}
            <button
              type="button"
              class="btn-close"
              (click)="errorMessage = null"
              aria-label="Close"
            ></button>
          </div>
          }

          <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
            <!-- Name Field -->
            <div class="mb-3">
              <label for="name" class="form-label">Full Name</label>
              <input
                type="text"
                id="name"
                formControlName="name"
                class="form-control"
                [ngClass]="{
                  'is-invalid': name?.invalid && (name?.dirty || name?.touched)
                }"
                placeholder="Enter your full name"
              />
              @if (name?.invalid && (name?.dirty || name?.touched)) {
              <div class="invalid-feedback">
                @if (name?.errors?.['required']) {
                <span>Name is required</span>
                }
              </div>
              }
            </div>

            <!-- Email Field -->
            <div class="mb-3">
              <label for="email" class="form-label">Email address</label>
              <input
                type="email"
                id="email"
                formControlName="email"
                class="form-control"
                [ngClass]="{
                  'is-invalid':
                    email?.invalid && (email?.dirty || email?.touched)
                }"
                placeholder="Enter your email"
              />
              @if (email?.invalid && (email?.dirty || email?.touched)) {
              <div class="invalid-feedback">
                @if (email?.errors?.['required']) {
                <span>Email is required</span>
                } @else if (email?.errors?.['email']) {
                <span>Please enter a valid email address</span>
                }
              </div>
              }
            </div>

            <!-- Password Field -->
            <div class="mb-3">
              <label for="password" class="form-label">Password</label>
              <input
                type="password"
                id="password"
                formControlName="password"
                class="form-control"
                [ngClass]="{
                  'is-invalid':
                    password?.invalid && (password?.dirty || password?.touched)
                }"
                placeholder="Create a password"
              />
              @if (password?.invalid && (password?.dirty || password?.touched))
              {
              <div class="invalid-feedback">
                @if (password?.errors?.['required']) {
                <span>Password is required</span>
                } @else if (password?.errors?.['minlength']) {
                <span>Password must be at least 6 characters</span>
                }
              </div>
              }
            </div>

            <!-- Confirm Password Field -->
            <div class="mb-3">
              <label for="confirmPassword" class="form-label"
                >Confirm Password</label
              >
              <input
                type="password"
                id="confirmPassword"
                formControlName="confirmPassword"
                class="form-control"
                [ngClass]="{
                  'is-invalid':
                    (confirmPassword?.invalid &&
                      (confirmPassword?.dirty || confirmPassword?.touched)) ||
                    (passwordMismatch && confirmPassword?.dirty)
                }"
                placeholder="Confirm your password"
              />
              @if ((confirmPassword?.invalid && (confirmPassword?.dirty ||
              confirmPassword?.touched)) || (passwordMismatch &&
              confirmPassword?.dirty)) {
              <div class="invalid-feedback">
                @if (confirmPassword?.errors?.['required']) {
                <span>Please confirm your password</span>
                } @else if (passwordMismatch) {
                <span>Passwords do not match</span>
                }
              </div>
              }
            </div>

            <!-- Terms and Conditions -->
            <div class="mb-4">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="terms" />
                <label class="form-check-label" for="terms">
                  I agree to the
                  <a href="#" class="text-primary">Terms of Service</a> and
                  <a href="#" class="text-primary">Privacy Policy</a>
                </label>
              </div>
            </div>

            <!-- Submit Button -->
            <div class="d-grid">
              <button
                type="submit"
                class="btn btn-primary btn-lg"
                [disabled]="registerForm.invalid || isSubmitting"
              >
                {{ isSubmitting ? "Creating account..." : "Register" }}
              </button>
            </div>
          </form>
        </div>

        <div class="card-footer bg-light p-3 text-center">
          <p class="mb-0">
            Already have an account?
            <a routerLink="/login" class="text-primary">Log in here</a>
          </p>
        </div>
      </div>
    </div>
  </div>
</div>
